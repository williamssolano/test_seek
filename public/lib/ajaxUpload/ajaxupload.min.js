(function(e){var t;e.fn.ajaxUpload=function(n){var r=e.extend({accept:["*"],name:"file",method:"POST",url:"/",data:false,onSubmit:function(){return true},onComplete:function(){return true}},n);return this.each(function(){var n=e(this);n.css("position","relative");n.setData=function(e){r.data=e};var i=e('<form style="margin: 0px !important; padding: 0px !important; position: absolute; top: 0px; left: 0px;"'+' method="'+r.method+'" enctype="multipart/form-data" action="'+r.url+'">'+' <input name="'+r.name+'" type="file" /></form>');var s=i.find("input[name="+r.name+"]");s.css("display","block");s.css("overflow","hidden");s.css("width","100%");s.css("height","100%");s.css("text-align","right");s.css("opacity","0");s.css("z-index","9999");s.change(function(t){i.find("input[type=hidden]").remove();r.onSubmit.call(n,e(this));if(r.data){e.each(r.data,function(t,n){i.append(e('<input type="hidden" name="'+t+'" value="'+n+'">'))})}i.submit();e(i).find("input[type=file]").attr("disabled","disabled")});e(n).append(i);if(!t){t=e('<iframe id="__ajaxUploadIFRAME" name="__ajaxUploadIFRAME"></iframe>').attr("style",'style="width:0px;height:0px;border:0px solid #fff;"').hide();t.attr("src","");e(document.body).append(t)}var o=function(){e(i).find("input[type=file]").removeAttr("disabled");var s=e(this).contents().find("html body").text();r.onComplete.call(n,s);t.unbind()};i.submit(function(e){t.load(o);i.attr("target","__ajaxUploadIFRAME");e.stopPropagation()})})}})(jQuery)